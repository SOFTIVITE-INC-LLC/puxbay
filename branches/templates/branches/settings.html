{% extends 'dashboard_base.html' %} 
{% load static %} 

{% block title %}Settings - {{ branch.name }}{% endblock %} 

{% block page_title %}Settings{% endblock %} 

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Header with Gradient -->
    <div class="mb-8">
        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl shadow-xl p-8 text-white">
            <div class="flex items-center gap-4">
                <div class="bg-white/20 backdrop-blur-sm p-3 rounded-xl">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                </div>
                <div>
                    <h1 class="text-3xl font-bold">Branch Settings</h1>
                    <p class="text-blue-100 mt-1">Configure {{ branch.name }} preferences</p>
                </div>
            </div>
        </div>
    </div>

    {% if messages %}
    <div class="mb-6 space-y-2">
        {% for message in messages %}
        <div class="p-4 rounded-xl {% if message.tags == 'success' %}bg-emerald-50 text-emerald-700 border border-emerald-200{% else %}bg-red-50 text-red-700 border border-red-200{% endif %} flex items-center gap-3">
            {% if message.tags == 'success' %}
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            {% else %}
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            {% endif %}
            <span class="text-sm font-medium">{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if form.non_field_errors %}
    <div class="mb-6 p-4 rounded-xl bg-red-50 text-red-700 border border-red-200">
        {% for error in form.non_field_errors %}
            <p class="text-sm font-medium flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                {{ error }}
            </p>
        {% endfor %}
    </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="space-y-6">
        {% csrf_token %}

        <!-- Inventory Configuration Card -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow">
            <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200">
                <div class="flex items-center gap-3">
                    <div class="bg-emerald-100 p-2 rounded-lg">
                        <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                    </div>
                    <div>
                         <h3 class="text-lg font-semibold text-slate-900">Branch Logo</h3>
                         <p class="text-xs text-slate-500">Upload a logo for your receipts</p>
                    </div>
                </div>
            </div>
            <div class="p-6">
                 <div class="max-w-md">
                    <label class="block text-sm font-medium text-slate-700 mb-2">Logo Image</label>
                    <div class="flex items-center gap-4">
                        {% if branch.logo %}
                            <img src="{{ branch.logo.url }}" alt="Current Logo" class="h-16 w-16 object-contain rounded-lg border border-slate-200">
                        {% endif %}
                        {{ form.logo }}
                    </div>
                    <p class="mt-2 text-xs text-slate-500">Recommended size: 300x100px. JPG or PNG.</p>
                 </div>
            </div>
        </div>

        <!-- Inventory Configuration Card -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow">
            <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200">
                <div class="flex items-center gap-3">
                    <div class="bg-emerald-100 p-2 rounded-lg">
                        <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-slate-900">Inventory Configuration</h3>
                        <p class="text-xs text-slate-500">Manage stock alerts and thresholds</p>
                    </div>
                </div>
            </div>
            <div class="p-6">
                <div class="max-w-md">
                    <label for="{{ form.low_stock_threshold.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-slate-700 mb-2">
                        <svg class="w-4 h-4 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                        Low Stock Alert Threshold
                    </label>
                    {{ form.low_stock_threshold }}
                    <p class="mt-2 text-xs text-slate-500 flex items-start gap-1">
                        <svg class="w-3 h-3 mt-0.5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        Products with stock below this number will be flagged as low stock
                    </p>
                    {% if form.low_stock_threshold.errors %}
                        <p class="mt-2 text-sm text-red-600 flex items-center gap-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            {{ form.low_stock_threshold.errors.0 }}
                        </p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- POS & Receipt Settings Card -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow">
            <div class="bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200">
                <div class="flex items-center gap-3">
                    <div class="bg-blue-100 p-2 rounded-lg">
                        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/></svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-slate-900">POS & Receipt Details</h3>
                        <p class="text-xs text-slate-500">Customize receipt appearance and currency</p>
                    </div>
                </div>
            </div>
            <div class="p-6 space-y-6">
                <!-- Currency Symbol -->
                <!-- Currency Settings -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="max-w-xs">
                        <label for="{{ form.currency_code.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-slate-700 mb-2">
                             <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                             Currency Code
                        </label>
                        {{ form.currency_code }}
                        {% if form.currency_code.errors %}
                            <p class="mt-2 text-sm text-red-600">{{ form.currency_code.errors.0 }}</p>
                        {% endif %}
                    </div>
                    
                    <div class="max-w-xs">
                        <label for="{{ form.currency_symbol.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-slate-700 mb-2">
                            <span class="text-slate-400 font-bold">$</span>
                            Currency Symbol
                        </label>
                        {{ form.currency_symbol }}
                        {% if form.currency_symbol.errors %}
                            <p class="mt-2 text-sm text-red-600">{{ form.currency_symbol.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Receipt Header -->
                <div>
                    <label for="{{ form.receipt_header.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-slate-700 mb-2">
                        <svg class="w-4 h-4 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                        Receipt Header
                    </label>
                    {{ form.receipt_header }}
                    <p class="mt-2 text-xs text-slate-500 flex items-start gap-1">
                        <svg class="w-3 h-3 mt-0.5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        Appears at the top of printed receipts (e.g., Business Name, Tax ID)
                    </p>
                </div>

                <!-- Receipt Footer -->
                <div>
                    <label for="{{ form.receipt_footer.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-slate-700 mb-2">
                        <svg class="w-4 h-4 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                        Receipt Footer
                    </label>
                    {{ form.receipt_footer }}
                    <p class="mt-2 text-xs text-slate-500 flex items-start gap-1">
                        <svg class="w-3 h-3 mt-0.5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        Appears at the bottom of printed receipts (e.g., Thank You, Return Policy)
                    </p>
                </div>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center justify-between">
                <button type="button" onclick="history.back()" class="inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
                    Cancel
                </button>
                <button type="submit" class="inline-flex items-center gap-2 px-6 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg shadow-lg shadow-blue-500/30 hover:shadow-blue-500/40 hover:from-blue-500 hover:to-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Save Changes
                </button>
            </div>
        </div>
    </form>
</div>
{% endblock %}
